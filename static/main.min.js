$(function(){var e=document.getElementById("supportMessage"),n=document.getElementById("voice"),t=document.getElementById("volume"),o=(document.getElementById("rate"),document.getElementById("pitch")),s=$(".cleverbotForm"),r=$(".query"),i=$(".thinking"),c=$(".speech-input"),a=function(){window.speechSynthesis.onvoiceschanged=function(){var e=window.speechSynthesis.getVoices();e.forEach(function(e,t){var o=document.createElement("option");o.value=t,o.innerHTML=e.name,n.appendChild(o)})}},u=function(){"speechSynthesis"in window?e.innerHTML="Your browser <strong>supports</strong> speech synthesis.":(e.innerHTML='Sorry your browser <strong>does not support</strong> speech synthesis.<br>Try this in <a href="http://www.google.co.uk/intl/en/chrome/browser/canary.html">Chrome Canary</a>.',e.classList.add("not-supported"))},p=function(e){var s=new SpeechSynthesisUtterance;s.text=e;var r=window.speechSynthesis.getVoices();s.voice=r[$(n).val()],s.volume=parseFloat($(t).val()),s.pitch=parseFloat($(o).val()),s.rate=1,window.speechSynthesis.speak(s)},h=function(e){l(),$.ajax({type:"POST",url:$SCRIPT_ROOT+"chat",data:e||s.serialize(),complete:function(e){var n=JSON.parse(e.responseText).message;p(n),d()},error:function(e){alert(e)}})},l=function(){i.show()},d=function(){i.hide()};s.on("submit",function(e){e.preventDefault(),h(),r.val("")}),c.on("click",function(e){e.preventDefault();var n,t=new webkitSpeechRecognition;t.start(),t.onresult=function(e){console.log(e.results[0][0].transcript),n=e.results[0][0].transcript,h("query="+n)}});var m=function(){u(),a()};m()});