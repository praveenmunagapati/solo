$(function(){var e=document.getElementById("supportMessage"),n=document.getElementById("voice"),t=(document.getElementById("volume"),document.getElementById("rate"),document.getElementById("pitch"),$(".cleverbotForm")),o=$(".query"),s=$(".thinking"),r=$(".speech-input"),i=function(){window.speechSynthesis.onvoiceschanged=function(){var e=window.speechSynthesis.getVoices();e.forEach(function(e,t){var o=document.createElement("option");o.value=t,o.innerHTML=e.name,n.appendChild(o)})}},c=function(){"speechSynthesis"in window?e.innerHTML="Your browser <strong>supports</strong> speech synthesis.":(e.innerHTML='Sorry your browser <strong>does not support</strong> speech synthesis.<br>Try this in <a href="http://www.google.co.uk/intl/en/chrome/browser/canary.html">Chrome Canary</a>.',e.classList.add("not-supported"))},a=function(e){var t=new SpeechSynthesisUtterance;t.text=e;var o=window.speechSynthesis.getVoices();t.voice=o[$(n).val()],t.volume=1,t.pitch=1,t.rate=1,window.speechSynthesis.speak(t)},u=function(e){p(),$.ajax({type:"POST",url:$SCRIPT_ROOT+"chat",data:e||t.serialize(),complete:function(e){var n=JSON.parse(e.responseText).message;a(n),h()},error:function(e){alert(e)}})},p=function(){s.show()},h=function(){s.hide()};t.on("submit",function(e){e.preventDefault(),u(),o.val("")}),r.on("click",function(e){e.preventDefault();var n,t=new webkitSpeechRecognition;t.start(),t.onresult=function(e){console.log(e.results[0][0].transcript),n=e.results[0][0].transcript,u("query="+n)}});var l=function(){c(),i()};l()});